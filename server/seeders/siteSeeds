let apiData;
let saveCounter = 0;


const url = ['https://developer.nps.gov/api/v1/parks?parkCode=acad&api_key=em9tUC920fypAgMENGc0OWfY7SfamU6icv4nEdsk']

url.map(async url => {

try{
  const response = await fetch(url);
  const json = await response.json();
  apiData = [...json];
  
  for (let i = 0; i < apiData.length; i++) {
  
  let parkSite = new Park({
    site_name: apiData[i].name,
    description: apiData[i].status,
    location: { 
      coordinates: [apiData[i].polygon.coordinates[0][0][1] , apiData[i].polygon.coordinates[0] [0] [0]]}
      })
      
   console.log({parkSite}   
   parkSite.save(() =>
    console.log("saved" + parkSite)
    
    saveCounter++;
    
    if (saveCounter === apiData.length) {
    
    mongoose.disconnect()
    .then(() => console.log("saved successfully and mongodb disconnected"))
    .catch(error => console.log(errorr));
    }
    });
    }}
    catch (error) {
    console.log(error);
    }
    })
